<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8' />
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.css' rel='stylesheet' />
    <link href='https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.1/css/all.css' rel='stylesheet'>  
    <link href='lib/main.css' rel='stylesheet' />
    <link href='main.css' rel='stylesheet' />
    <script src='lib/main.js'></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-E57BQSEY0M"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-E57BQSEY0M');
    </script>
    
    
    
    
    <script>

    function readTextFile(file, callback) {
        var rawFile = new XMLHttpRequest();
        rawFile.overrideMimeType("application/json");
        rawFile.open("GET", file, true);
        rawFile.onreadystatechange = function() {
            if (rawFile.readyState === 4 && rawFile.status == "200") {
                callback(rawFile.responseText);
            }
        }
        rawFile.send(null);
        //return rawFile.responseText;
    }


    document.addEventListener('DOMContentLoaded', async function() {

      var calendarEl = document.getElementById('calendar');

      await readTextFile("events.json", function(text){
        var data = JSON.parse(text); 
        console.log(data);
        var calendar = new FullCalendar.Calendar(calendarEl, {
        //timeZone: 'UTC',
        height: 900,
        events: data,
        //initialDate: '2021-11-07',
        headerToolbar: {
          left: 'prev,next today',
          center: 'title',
          right: 'dayGridMonth,timeGridWeek,timeGridDay'
        },
        // initialView: 'listWeek',
        themeSystem: 'darkly', //bootstrap
        initialView: 'dayGridMonth',
        // eventRender:   function eventRender(event, element, view) {
        //     return ['all', event.cName].indexOf(document.getElementById('type_selector').val()) >= 0;}
        dateClick: function(info) {
          if(info.view.type=="dayGridMonth"){
              this.changeView("timeGridDay",info.dateStr);
          }
        }, 
        // eventMouseEnter: function( mouseEnterInfo ) { 
        //   var dd = data[ parseInt(mouseEnterInfo.event.id)];
        //   document.getElementById("img").src = dd.image;
        //   document.getElementById("title").textContent = dd.title;
        //   //console.log(dd);
        //   document.getElementById("description").textContent = dd.description;
        // },

        eventClick: function(info) {
        info.jsEvent.preventDefault(); // don't let the browser navigate

        var dd = data[ parseInt(info.event.id)];
        document.getElementById("img").src = dd.image;
        document.getElementById("title").textContent = dd.title;
        //console.log(dd);
        document.getElementById("description").textContent = dd.description;

        // if (info.event.url) {
        //   window.open(info.event.url);
        // }
      }

      });
      calendar.render();

      
    })
    // document.getElementById('type_selector').on_change = function () {
    // document.getElementById('calendar').fullCalendar('rerenderEvents');
    //};

    });



    </script>
  </head>
  <body class="mainbody">

<!--   <div align='center'>
    <select id="type_selector">
      <option value="all">All types</option>
      <option value="oblo">Oblo</option>
      <option value="cinemateque">Cinemateque</option>
      <option value="zinema">Zinema</option>
      <option value="salopard">Salopard</option>
  </select> -->
<div>

<center><h1 class="maintitle">Lapena Lausanne</h1></center>
<center><h2 class="subtitle">Agenda sousterrain</h2></center>

</div>
<div class="row">
  <div class="column_calendar" id='calendar' style="max-width: 1100px;margin: 40px auto; padding: 40px"></div>
  <div class="column"><img id='img' width='300px' src=''> <h2 id='title'></h2><p id='description'></p></div>
</div>

    

    
  </body>
</html>
